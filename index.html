<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuestro Primer A√±o üíû</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      background: radial-gradient(circle at center, #ffd6e0 0%, #f0b3d1 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Poppins", sans-serif;
      transition: background 2s ease;
    }

    .scene {
      position: relative;
      width: 260px;
      height: 230px;
      perspective: 1000px;
      cursor: pointer;
      transition: transform 2s ease, opacity 2s ease;
      z-index: 5;
    }

    .zoom-in {
      transform: scale(8);
      opacity: 0;
    }

    .heart-base {
      background: url('images/Sin\ t√≠tulo-1.png') no-repeat center/contain;
      position: absolute;
      width: 260px;
      height: 230px;
    }

    .heart-lid {
      position: absolute;
      width: 260px;
      height: 230px;
      background: url('https://images.emojiterra.com/google/noto-emoji/unicode-15/color/512px/1f49d.png') no-repeat center/contain;
      transform-origin: top center;
      transition: transform 1.2s ease;
      z-index: 6;
    }

    .heart-lid.open {
      transform: rotateX(-130deg);
    }

    .inside {
      position: fixed;
      inset: 0;
      background: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      opacity: 0;
      pointer-events: none;
      transform: scale(0.8);
      transition: opacity 1.2s ease, transform 1.6s ease;
      z-index: 20;
    }

    .inside.active {
      opacity: 1;
      pointer-events: all;
      transform: scale(1);
    }

    h1 {
      color: #b21f66;
      margin: 15px 0 5px;
      font-size: 1.4rem;
      text-align: center;
    }

    p {
      color: #7a4e7c;
      margin: 0 15px 10px;
      text-align: center;
      font-size: 0.9rem;
    }

    .carousel {
      display: flex;
      overflow: hidden;
      width: 100%;
      height: calc(100vh - 180px);
      position: relative;
      touch-action: pan-y;
    }

    .nav-btn {
  position: absolute;
  top: 50%; /* Centra verticalmente */
  transform: translateY(-50%);
  background: rgba(178, 31, 102, 0.7); /* Fondo semi-transparente del color del tema */
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.9rem;
  z-index: 10; /* Asegura que est√©n por encima del carrusel */
  transition: background 0.3s, opacity 0.3s;
}

.nav-btn:hover {
  background: #8b1450;
}

.nav-btn:disabled {
  opacity: 0.5; /* Opacidad reducida cuando est√°n deshabilitados */
  cursor: default;
}

.prev-btn {
  left: 10px;
}

.next-btn {
  right: 10px;
}

    .carousel-track {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.35s cubic-bezier(.22,.9,.27,1);
      will-change: transform;
      -webkit-tap-highlight-color: transparent;
    }

    .slide {
      flex: 0 0 100%;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 10px;
    }

    .slide img, .slide video {
      width: 90%;
      max-height: 60vh;
      object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      user-select: none;
    }

    .slide p {
      margin-top: 10px;
      color: #5a3b60;
      font-size: 0.95rem;
    }

    button {
      background: #b21f66;
      color: white;
      border: none;
      padding: 10px 25px;
      border-radius: 25px;
      font-size: 1rem;
      margin: 20px 0;
      cursor: pointer;
      transition: background 0.3s;
      z-index: 30;
    }

    button:hover { background: #8b1450; }

    footer {
      color: #777;
      font-size: 0.8rem;
      margin-bottom: 10px;
    }
.nav-btn {
  position: absolute;
  top: 80%;
  transform: translateY(-50%);
  background: rgba(178, 31, 102, 0.7); /* Fondo semi-transparente del color del tema */
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: bold;
  z-index: 10;
  transition: background 0.3s, opacity 0.3s;
  user-select: none; /* Evita la selecci√≥n de texto */
  -webkit-tap-highlight-color: transparent; /* Mejora la experiencia m√≥vil */
}

.nav-btn:hover {
  background: #8b1450;
}

.nav-btn:disabled {
  opacity: 0.3; /* Opacidad reducida cuando est√°n deshabilitados */
  cursor: default;
}

.prev-btn {
  left: 10px;
}

.next-btn {
  right: 10px;
}
/* --------------------------------------------- */

  </style>
</head>
<body>
  <div class="scene" id="scene">
    <div class="heart-base"></div>
    <div class="heart-lid" id="lid"></div>
  </div>

  <div class="inside" id="inside">
    <h1>Nuestro primer a&ntilde;itoüí´</h1>
    <p>Por muchos m&aacute;s juntitos.</p>

    <div class="carousel" id="carousel">
        <button id="prevBtn" class="nav-btn prev-btn"><</button>
        <button id="nextBtn" class="nav-btn next-btn">></button>

        <div class="carousel-track" id="track">
            <div class="slide">
                <img src="images/diciembre.jpg" alt="foto1">
                <p>‚ú® Los ojitos que me enamoraron</p>
            </div>

            <div class="slide">
                <video src="images/enero.mp4" autoplay muted loop playsinline></video>
                <p>üåπ Como no enamorarme con esos ojitos</p>
            </div>

            <div class="slide">
                <video src="images/febrero.mp4" autoplay muted loop playsinline></video>
                <p>üíã Cada d&iacute;a me dan m&aacute;s ganas de besar esa boquita</p>
            </div>

            <div class="slide">
                <video src="images/marzo.mp4" autoplay muted loop playsinline></video>
                <p>üíû No hay paisaje m&aacute;s hermoso que tu cuerpo</p>
            </div>

            <div class="slide">
                <img src="images/abril.jpg">
                <p>ü•∞ Todav&iacute;a me pongo nervioso al verte</p>
            </div>

            <div class="slide">
                <video src="images/junio.mp4" autoplay muted loop playsinline></video>
                <p>üíò Cada d&iacute;a me enamoro m&aacute;s de la hermosa persona que sos</p>
            </div>

            <div class="slide">
                <img src="images/julio.png">
                <p>üíã Cada d&iacute;a me dan m&aacute;s ganas de besar esa boquita</p>
            </div>

            <div class="slide">
                <img src="images/agosto.jpg">
                <p>üåπ Cada vez que veo esa carita me roba el corazon</p>
            </div>

            <div class="slide">
                <img src="images/septiembre.jpg">
                <p>‚ù£ Me emociona cada uno de tus te amo</p>
            </div>

            <div class="slide">
                <img src="images/octubre.png">
                <p>üí´ Gracias por todos los momentos hermosos</p>
            </div>

            <div class="slide">
                <img src="images/noviembre.jpg">
                <p>üíï Gracias por hacerme tan bien</p>
            </div>

            <div class="slide">
                <img src="images/diciembre25.png">
                <p>üíù Por muchos m&aacute;s momentos y a&ntilde;os a tu lado</p>
            </div>
        </div>
    </div>
    <button id="closeBtn">Cerrar</button>
</div>

  <script>
    const lid = document.getElementById('lid');
    const inside = document.getElementById('inside');
    const scene = document.getElementById('scene');
    const closeBtn = document.getElementById('closeBtn');

    // --- NUEVAS REFERENCIAS PARA LOS BOTONES ---
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    // -------------------------------------------

    scene.addEventListener('click', () => {
        lid.classList.add('open');
        setTimeout(() => { scene.classList.add('zoom-in'); }, 700);

        setTimeout(() => {
            document.body.style.background = "white";
            inside.classList.add('active');
            moveToIndex(0, false);
            playVideoAtIndex(0);
        }, 2200);
    });

    closeBtn.addEventListener('click', () => {
        inside.classList.remove('active');
        document.body.style.background = "radial-gradient(circle at center, #ffd6e0 0%, #f0b3d1 100%)";
        moveToIndex(0, false);
        setTimeout(() => { scene.classList.remove('zoom-in'); lid.classList.remove('open'); }, 400);
    });

    // ----------------------------
    //        CARRUSEL / SWIPE
    // ----------------------------

    const carousel = document.getElementById('carousel');
    const track = document.getElementById('track');
    const slides = Array.from(track.children);

    let index = 0, startX = 0, currentTranslate = 0, prevTranslate = 0;
    let dragging = false, animationFrameId = null;

    function getWidth() { return carousel.clientWidth; }
    function setTranslate(x, el = track) { el.style.transform = `translateX(${x}px)`; }
    function animation() {
        setTranslate(currentTranslate);
        animationFrameId = requestAnimationFrame(animation);
    }

    function touchStart(x) {
        startX = x;
        dragging = true;
        prevTranslate = -index * getWidth();
        currentTranslate = prevTranslate;
        cancelAnimationFrame(animationFrameId);
        animationFrameId = requestAnimationFrame(animation);
    }

    function touchMove(x) {
        if (!dragging) return;
        currentTranslate = prevTranslate + (x - startX);
    }

    function touchEnd(x) {
        if (!dragging) return;
        dragging = false;
        cancelAnimationFrame(animationFrameId);

        const moved = x - startX;
        const t = getWidth() * 0.15;

        if (moved < -t && index < slides.length - 1) index++;
        else if (moved > t && index > 0) index--;

        moveToIndex(index, true);
    }

    // ----------------------------
    //      REPRODUCCI√ìN DE VIDEOS Y BOTONES
    // ----------------------------

    function playVideoAtIndex(i) {
        slides.forEach((slide, idx) => {
            const v = slide.querySelector("video");
            if (!v) return;

            v.muted = true;
            v.playsInline = true;

            if (idx === i) {
                // Tries to play, catches if the browser prevents it (e.g., policy)
                v.play().catch(() => {});
            } else {
                v.pause();
                v.currentTime = 0;
            }
        });
    }

    // Funci√≥n para habilitar/deshabilitar los botones de navegaci√≥n
    function updateNavButtons() {
        prevBtn.disabled = index === 0;
        nextBtn.disabled = index === slides.length - 1;
    }

    function moveToIndex(i, animate = true) {
        index = i;
        const x = -index * getWidth();

        track.style.transition = animate
            ? 'transform 0.35s cubic-bezier(.22,.9,.27,1)'
            : 'none';

        setTranslate(x);

        if (animate) {
            track.addEventListener('transitionend', () => {
                track.style.transition = 'none';
                playVideoAtIndex(index);
            }, { once: true });
        } else {
            playVideoAtIndex(index);
        }
        
        // Actualiza el estado de los botones
        updateNavButtons();
    }

    // ----------------------------
    //      EVENTOS DE GESTOS Y BOTONES
    // ----------------------------

    // Para evitar la navegaci√≥n t√°ctil accidental fuera del carrusel
    track.addEventListener('touchstart', e => {
        // Permitimos el default en el evento touchstart para que los videos puedan cargarse/reproducirse
        touchStart(e.touches[0].clientX);
    }, { passive: true }); // Usamos passive: true para que el navegador sepa que no bloquearemos el scroll
    
    // Aqu√≠ bloqueamos el default para asegurar que el movimiento sea de carrusel y no scroll
    track.addEventListener('touchmove', e => {
        // e.preventDefault(); // Si se usa preventDefault, se bloquea el scroll vertical. Ya lo maneja el CSS 'touch-action: none' en <body>.
        touchMove(e.touches[0].clientX);
    }, { passive: true });

    track.addEventListener('touchend', e => touchEnd(e.changedTouches[0].clientX));

    // Eventos de rat√≥n para desktop
    track.addEventListener('mousedown', e => { e.preventDefault(); touchStart(e.clientX); });
    window.addEventListener('mousemove', e => { if (dragging) touchMove(e.clientX); });
    window.addEventListener('mouseup', e => { if (dragging) touchEnd(e.clientX); });

    window.addEventListener('resize', () => moveToIndex(index, false));

    slides.forEach(s => {
        const img = s.querySelector('img');
        if (img) img.addEventListener('dragstart', e => e.preventDefault());
    });

    // --- LISTENERS PARA LOS BOTONES DE NAVEGACI√ìN ---
    prevBtn.addEventListener('click', () => {
        if (index > 0) moveToIndex(index - 1, true);
    });

    nextBtn.addEventListener('click', () => {
        if (index < slides.length - 1) moveToIndex(index + 1, true);
    });
    // ------------------------------------------------

    // Iniciar posici√≥n y estado de botones
    moveToIndex(0, false);
</script>
</body>
</html>
